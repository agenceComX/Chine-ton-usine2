import{g as R,j as e,x as B,r as l,P as D,X as T,ab as A,J as F,T as q}from"./index-DbrDj4Du.js";import{c as P}from"./containerService-t0n3X4-G.js";import{C as E}from"./calendar-B40bxLxD.js";import{T as I}from"./trending-up-BtbguRz-.js";import{T as z}from"./trending-down-DQd0f0sf.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],O=R("compass",Q);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]],V=R("euro",_),U=({progress:a,color:c="bg-blue-500",height:x="h-4"})=>{const u=Math.max(0,Math.min(100,a));return e.jsx("div",{className:`w-full ${x} bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden`,children:e.jsx("div",{className:`${c} ${x} rounded-full transition-all duration-500 ease-out`,style:{width:`${u}%`}})})},J=({container:a,isOpen:c,onClose:x,onPreorder:u})=>{const{t}=B(),[h,p]=l.useState(1);if(!c)return null;const y=m=>{m.preventDefault(),u(a.id,h),x()};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-lg shadow-xl w-full max-w-md mx-auto",children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:[t("preorder.title")," ",a.name]}),e.jsx("p",{className:"text-gray-600 mb-6",children:t("preorder.description")}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:[t("containers.departure"),":"]})," ",a.departureLocation]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:[t("containers.arrival"),":"]})," ",a.arrivalLocation]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:[t("containers.estimatedDeparture"),":"]})," ",new Date(a.estimatedDepartureDate).toLocaleDateString()]}),e.jsxs("p",{className:"text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:[t("containers.capacity"),":"]})," ",a.usedCapacity,"/",a.totalCapacity," CBM"]})]}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"quantity",className:"block text-sm font-medium text-gray-700 mb-2",children:t("preorder.quantity")}),e.jsx("input",{type:"number",id:"quantity",value:h,onChange:m=>p(Number(m.target.value)),min:"1",max:a.totalCapacity-a.usedCapacity,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:x,className:"px-5 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-75",children:t("cancel")}),e.jsx("button",{type:"submit",className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75",children:t("preorder.confirm")})]})]})]})})},X=({container:a,isOpen:c,onClose:x,onReserve:u})=>{const[t,h]=l.useState(0),[p,y]=l.useState(!1),[m,g]=l.useState(""),[k,f]=l.useState(!1),[w,b]=l.useState(!1),[n,C]=l.useState(!1),d=a.totalCapacity-a.usedCapacity,M=150,S=t*M,v=new Date;v.setDate(v.getDate()+7);const N=a.usedCapacity/a.totalCapacity*100,$=t/a.totalCapacity*100,s=100-N-$;l.useEffect(()=>(c?(y(!0),document.body.style.overflow="hidden"):(document.body.style.overflow="unset",h(0),g(""),f(!1)),()=>{document.body.style.overflow="unset"}),[c]),l.useEffect(()=>{t>d?g(`Quantité maximale disponible: ${d} CBM`):t<=0?g("Veuillez sélectionner une quantité"):g("")},[t,d]);const r=j=>{const L=parseInt(j.target.value);h(L),C(!0),setTimeout(()=>C(!1),200),b(!0),setTimeout(()=>b(!1),300)},i=async()=>{if(!(t<=0||t>d)){f(!0);try{await new Promise(j=>setTimeout(j,1500)),u(a.id,t,S),o()}catch{g("Erreur lors de la réservation. Veuillez réessayer.")}finally{f(!1)}}},o=()=>{y(!1),setTimeout(()=>{x()},300)};return c?e.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 transition-all duration-300 ${p?"opacity-100":"opacity-0"}`,onClick:o,children:e.jsxs("div",{className:`glassmorphism container-reservation-modal rounded-2xl shadow-2xl w-full max-w-2xl transform transition-all duration-500 ${p?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:e.jsx(D,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Réserver de l'espace"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.name})]})]}),e.jsx("button",{onClick:o,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:e.jsx(T,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Départ"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.departureLocation})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Arrivée"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.arrivalLocation})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Date de départ"}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:new Date(a.estimatedDepartureDate).toLocaleDateString("fr-FR")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Capacité disponible"}),e.jsxs("p",{className:"font-medium text-green-600 dark:text-green-400",children:[d," CBM"]})]})]}),e.jsxs("div",{className:"space-y-4",children:["            ",e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Quantité à réserver"}),e.jsxs("div",{className:`text-2xl font-bold text-blue-600 dark:text-blue-400 quantity-display ${n?"updating":""}`,children:[t," CBM"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"range",min:"0",max:d,value:t,onChange:r,className:"w-full container-reservation-slider smooth-transition",style:{background:`linear-gradient(to right, #3B82F6 0%, #3B82F6 ${t/d*100}%, var(--modal-slider-track) ${t/d*100}%, var(--modal-slider-track) 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx("span",{children:"0"}),e.jsxs("span",{children:[d," CBM"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Répartition de la capacité"}),"            ",e.jsxs("div",{className:"relative w-full h-6 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 h-full bg-red-500 progress-bar-segment",style:{width:`${N}%`}}),e.jsx("div",{className:"absolute top-0 h-full bg-blue-500 progress-bar-segment",style:{left:`${N}%`,width:`${$}%`}}),e.jsx("div",{className:"absolute top-0 right-0 h-full bg-green-500 progress-bar-segment",style:{width:`${s}%`}})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Utilisé (",a.usedCapacity," CBM)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Sélectionné (",t," CBM)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Disponible (",d-t," CBM)"]})]})]})]}),"          ",e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg info-card smooth-transition hover:shadow-lg",children:[e.jsx("div",{className:"icon-animate",children:e.jsx(V,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Prix estimé"}),e.jsxs("p",{className:`text-xl font-bold text-blue-600 dark:text-blue-400 ${w?"price-animate":""}`,children:[S.toLocaleString("fr-FR")," €"]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[M,"€/CBM"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg info-card smooth-transition hover:shadow-lg",children:[e.jsx("div",{className:"icon-animate",children:e.jsx(E,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Date limite"}),e.jsx("p",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:v.toLocaleDateString("fr-FR")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Dans 7 jours"})]})]})]}),"          ",m&&e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg error-message",children:[e.jsx(A,{className:"w-5 h-5 text-red-500 icon-animate"}),e.jsx("p",{className:"text-red-700 dark:text-red-400 text-sm",children:m})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:o,className:"flex-1 px-6 py-3 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Annuler"}),"          ",e.jsx("button",{onClick:i,disabled:!!m||t<=0||k,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-300 dark:disabled:bg-gray-600 disabled:cursor-not-allowed validation-button smooth-transition flex items-center justify-center space-x-2",children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full button-spinner"}),e.jsx("span",{children:"Réservation..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-5 h-5 icon-animate"}),e.jsx("span",{children:"Valider la réservation"})]})})]}),"      "]})}):null},Z=()=>{const[a,c]=l.useState([]),[x,u]=l.useState(!0),[t,h]=l.useState(null),[p,y]=l.useState(null),[m,g]=l.useState(!1),[k,f]=l.useState(!1),[w,b]=l.useState(null),{t:n}=B();l.useEffect(()=>{const s=async()=>{try{u(!0);const i=await P.getContainers();c(i)}catch(i){const o=i instanceof Error?i.message:"Erreur lors du chargement des conteneurs.";h(o)}finally{u(!1)}};s();const r=setInterval(s,1e4);return()=>clearInterval(r)},[]);const C=s=>{y(s),g(!0)},d=s=>{b(s),f(!0)},M=async(s,r,i)=>{try{console.log(`Reservation for container ${s}: ${r} CBM at ${i}€`),alert(`Réservation confirmée!
${r} CBM réservés pour ${i}€`);const o=await P.getContainers();c(o),f(!1),b(null)}catch(o){console.error("Error creating reservation:",o),alert("Erreur lors de la création de la réservation")}},S=async(s,r)=>{try{console.log(`Preorder for container ${s}: ${r} CBM`),alert(n("preorder.success"));const i=await P.getContainers();c(i)}catch(i){console.error("Error creating preorder:",i),alert("Erreur lors de la création de la précommande")}},v=()=>{g(!1),y(null)},N=()=>{f(!1),b(null)},$=s=>{const r=s.usedCapacity/s.totalCapacity*100;return s.status==="closed"?"bg-gray-500":r>=90?"bg-red-500":r>=70?"bg-orange-500":"bg-green-500"};return x?e.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white",children:e.jsx("p",{children:n("containers.loading")})}):t?e.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-100 dark:bg-gray-900 text-red-500",children:e.jsxs("p",{children:[n("containers.error"),": ",t]})}):e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white p-4 sm:p-6 lg:p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center sm:text-left",children:n("containers.title")}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(s=>{const r=s.usedCapacity/s.totalCapacity*100,i=$(s);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-3 flex items-center",children:[e.jsx(D,{className:"mr-2 text-blue-600"})," ",s.name]}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(q,{className:"mr-2 text-gray-500"}),n("containers.departure"),": ",e.jsx("span",{className:"font-medium ml-1",children:s.departureLocation})]}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(O,{className:"mr-2 text-gray-500"}),n("containers.arrival"),": ",e.jsx("span",{className:"font-medium ml-1",children:s.arrivalLocation})]}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[e.jsx(E,{className:"mr-2 text-gray-500"}),n("containers.estimatedDeparture"),": ",e.jsx("span",{className:"font-medium ml-1",children:s.estimatedDepartureDate})]}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 mb-4 flex items-center",children:[s.status==="active"?e.jsx(I,{className:"mr-2 text-green-600"}):e.jsx(z,{className:"mr-2 text-gray-500"}),n("containers.status"),": ",e.jsx("span",{className:`font-medium ml-1 capitalize ${s.status==="active"?"text-green-600":"text-gray-500"}`,children:n(`containers.status.${s.status}`)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 text-sm mb-1",children:[n("containers.capacity"),": ",s.usedCapacity," / ",s.totalCapacity]}),e.jsx(U,{progress:r,color:i,height:"h-3"})]})]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4",children:[s.status==="closed"&&e.jsx("p",{className:"text-red-500 font-semibold",children:n("containers.closedMessage")}),"                ",s.status==="active"&&r>=90&&r<100&&e.jsx("p",{className:"text-orange-500 font-semibold",children:n("containers.almostFullMessage")}),s.status==="active"&&r<90&&e.jsx("p",{className:"text-green-600 font-semibold",children:n("containers.availableMessage")})]}),s.status==="active"&&r<100&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600 space-y-3",children:[e.jsxs("button",{onClick:()=>d(s),className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-4 py-3 rounded-lg font-medium transition-all duration-200 flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl transform hover:scale-105",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{children:"Réserver de l'espace"})]}),e.jsxs("button",{onClick:()=>C(s),className:"w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center justify-center space-x-2",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:n("preorder.button")})]})]})]},s.id)})}),"      ",p&&e.jsx(J,{container:p,isOpen:m,onClose:v,onPreorder:S}),w&&e.jsx(X,{container:w,isOpen:k,onClose:N,onReserve:M})]})};export{Z as default};
