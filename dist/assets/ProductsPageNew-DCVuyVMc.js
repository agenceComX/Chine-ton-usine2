import{g as _,r as h,j as e,X as B,x as G,B as A,P as R,W as L,a as Q,b as X,F as Z}from"./index-DbrDj4Du.js";import{B as P}from"./Button-BXIi94zn.js";import{I as q}from"./Input-CQoVujND.js";import{E as J}from"./eye-BDcpPqwB.js";import{u as D}from"./uploadService-BcwHIp7b.js";import{D as ee}from"./dollar-sign-CGhSt0s-.js";import{S as se}from"./save-_HupyZYA.js";import{S as re}from"./SupplierLayout-BDztLqG7.js";import{u as te}from"./useToastContext-TG_IWIBh.js";import{p as U}from"./productsService-Dn4X7My8.js";import{P as ae}from"./plus-7lddUlfR.js";import{S as le}from"./square-pen-Ct6V3DPX.js";import{T as ie}from"./trash-2-ZdXwmmSk.js";import"./message-square-BGKFoHMd.js";import"./chart-column-zn556lbz.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],oe=_("camera",ne);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],de=_("tag",ce),me=({onImageSelect:x,onUpload:j,maxImages:a=10,maxSizePerImage:v=10,className:g="",existingImages:T=[],onRemoveExisting:l})=>{const[i,f]=h.useState(()=>T.map((r,o)=>({id:`existing-${o}`,preview:r,status:"existing",url:r}))),[w,y]=h.useState(!1),[k,n]=h.useState(!1),[C,S]=h.useState(null),I=h.useRef(null),O=()=>Math.random().toString(36).substr(2,9),$=r=>{if(r===0)return"0 Bytes";const o=1024,m=["Bytes","KB","MB","GB"],c=Math.floor(Math.log(r)/Math.log(o));return parseFloat((r/Math.pow(o,c)).toFixed(2))+" "+m[c]},E=r=>r.type.startsWith("image/")?r.size>v*1024*1024?`L'image ${r.name} dépasse la taille maximale de ${v}MB`:null:`Le fichier ${r.name} n'est pas une image`,z=r=>new Promise((o,m)=>{const c=new FileReader;c.onload=p=>o(p.target?.result),c.onerror=()=>m("Erreur lors de la lecture du fichier"),c.readAsDataURL(r)}),M=async r=>{const o=Array.from(r);if(i.length+o.length>a){alert(`Vous ne pouvez télécharger que ${a} images au maximum`);return}const m=[],c=[];for(const u of o){const b=E(u);b?m.push(b):c.push(u)}if(m.length>0&&alert(m.join(`
`)),c.length===0)return;const p=[];for(const u of c)try{const b=await z(u);p.push({file:u,id:O(),preview:b,status:"pending"})}catch(b){console.error("Erreur lors de la création de la prévisualisation:",b)}f(u=>[...u,...p]),x?.(c)},s=r=>{r.preventDefault(),y(!1),M(r.dataTransfer.files)},t=r=>{r.preventDefault(),y(!0)},d=r=>{r.preventDefault(),y(!1)},N=r=>{r.target.files&&M(r.target.files)},V=r=>{const o=i.find(m=>m.id===r);o?.status==="existing"&&o.url&&l&&l(o.url),f(m=>m.filter(c=>c.id!==r))},K=async r=>new Promise(o=>{f(p=>p.map(u=>u.id===r.id?{...u,status:"uploading",progress:0}:u));let m=0;const c=setInterval(()=>{if(m+=Math.random()*20,m>=100){m=100,clearInterval(c);const p=`https://example.com/uploads/${r.file?.name}`;f(u=>u.map(b=>b.id===r.id?{...b,progress:100,status:"success",url:p}:b)),o(p)}else f(p=>p.map(u=>u.id===r.id?{...u,progress:m}:u))},200)}),H=async()=>{const r=i.filter(o=>o.status==="pending"&&o.file);if(r.length!==0){n(!0);try{if(j){const o=r.map(c=>c.file),m=await j(o);f(c=>c.map(p=>{const u=r.findIndex(b=>b.id===p.id);return u!==-1?{...p,status:"success",url:m[u]}:p}))}else for(const o of r)await K(o)}catch(o){console.error("Erreur lors de l'upload:",o),f(m=>m.map(c=>r.some(p=>p.id===c.id)?{...c,status:"error"}:c))}finally{n(!1)}}},W=()=>{f(r=>r.filter(o=>o.status!=="success"))},Y=r=>{switch(r.status){case"uploading":return e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-white border-t-transparent mx-auto mb-2"}),e.jsxs("p",{className:"text-sm",children:[Math.round(r.progress||0),"%"]})]})});case"success":return e.jsx("div",{className:"absolute top-2 right-2 bg-green-500 text-white rounded-full p-1",children:e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})});case"error":return e.jsx("div",{className:"absolute inset-0 bg-red-500 bg-opacity-50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("svg",{className:"h-8 w-8 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm",children:"Erreur"})]})});default:return null}};return e.jsxs("div",{className:`space-y-4 ${g}`,children:[e.jsx("div",{onDrop:s,onDragOver:t,onDragLeave:d,onClick:()=>I.current?.click(),className:`
          border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-all duration-200
          ${w?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}
        `,children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(oe,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Déposez vos images ici"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"ou cliquez pour sélectionner des images"}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Formats: JPG, JPEG, PNG, GIF | Taille max: ",v,"MB par image | Max ",a," images"]})]})}),e.jsx("input",{ref:I,type:"file",multiple:!0,accept:"image/*",onChange:N,className:"hidden"}),i.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Images (",i.length,"/",a,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{onClick:W,variant:"outline",size:"sm",disabled:!i.some(r=>r.status==="success"),children:"Nettoyer"}),e.jsx(P,{onClick:H,disabled:k||!i.some(r=>r.status==="pending"),size:"sm",children:k?"Upload en cours...":`Télécharger (${i.filter(r=>r.status==="pending").length})`})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:i.map(r=>e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"aspect-square bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:[e.jsx("img",{src:r.preview,alt:r.file?.name||"Image",className:"w-full h-full object-cover"}),Y(r)]}),e.jsx("div",{className:"absolute top-2 left-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:o=>{o.stopPropagation(),S(r.preview)},className:"bg-black bg-opacity-50 text-white p-1 rounded hover:bg-opacity-75 transition-colors",title:"Prévisualiser",children:e.jsx(J,{className:"h-3 w-3"})})}),e.jsx("button",{onClick:()=>V(r.id),className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100",title:"Supprimer",children:e.jsx(B,{className:"h-3 w-3"})}),r.file&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",title:r.file.name,children:r.file.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:$(r.file.size)})]})]},r.id))})]}),C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",onClick:()=>S(null),children:e.jsxs("div",{className:"relative max-w-4xl max-h-4xl p-4",children:[e.jsx("img",{src:C,alt:"Prévisualisation",className:"max-w-full max-h-full object-contain"}),"            ",e.jsx("button",{onClick:()=>S(null),className:"absolute top-2 right-2 bg-white dark:bg-gray-800 text-black dark:text-white p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:e.jsx(B,{className:"h-4 w-4"})})]})})]})},ue=["Électronique","Vêtements","Maison & Jardin","Automobiles","Beauté","Sports","Jouets","Livres","Industrie","Autre"],xe=({isOpen:x,onClose:j,product:a,onSave:v})=>{const{t:g,language:T}=G(),[l,i]=h.useState({name:"",description:"",price:0,category:"",images:[],stock:0,sku:"",minOrder:1,tags:[],brand:"",origin:"",material:"",modelNumber:""}),[f,w]=h.useState(""),[y,k]=h.useState(!1),[n,C]=h.useState({});h.useEffect(()=>{if(a){let s="";typeof a.description=="string"?s=a.description:s=a.description.fr||a.description.en||Object.values(a.description)[0]||"",i({name:A(a,T),description:s,price:typeof a.price=="number"?a.price:a.price.cny,category:a.category,images:a.images||[],stock:100,sku:a.id||"",minOrder:a.moq||1,tags:[],brand:String(a.specifications?.brand||""),origin:String(a.specifications?.origin||""),material:String(a.specifications?.material||""),modelNumber:String(a.specifications?.modelNumber||"")})}else i({name:"",description:"",price:0,category:"",images:[],stock:0,sku:"",minOrder:1,tags:[],brand:"",origin:"",material:"",modelNumber:""});C({})},[a,x]);const S=()=>{const s={};return l.name.trim()||(s.name="Le nom du produit est requis"),l.description.trim()||(s.description="La description est requise"),l.price<=0&&(s.price="Le prix doit être supérieur à 0"),l.category||(s.category="La catégorie est requise"),l.sku.trim()||(s.sku="L'ID Produit est requis"),l.stock<0&&(s.stock="Le stock ne peut pas être négatif"),l.minOrder<=0&&(s.minOrder="La commande minimum doit être supérieure à 0"),l.brand.trim()||(s.brand="La marque est requise"),l.origin.trim()||(s.origin="L'origine est requise"),C(s),Object.keys(s).length===0},I=async s=>{try{const d=(await D.uploadImages(s,{folder:"products",maxWidth:1200,maxHeight:1200,quality:.8,maxSize:5})).filter(N=>N.success).map(N=>N.url).filter(Boolean);return i(N=>({...N,images:[...N.images,...d]})),d}catch(t){throw console.error("Erreur lors de l'upload des images:",t),t}},O=async s=>{try{s.includes("example.com")&&await D.deleteFile(s),i(t=>({...t,images:t.images.filter(d=>d!==s)}))}catch(t){console.error("Erreur lors de la suppression de l'image:",t)}},$=s=>{s.key==="Enter"&&(s.preventDefault(),E())},E=()=>{f.trim()&&!l.tags.includes(f.trim())&&(i(s=>({...s,tags:[...s.tags,f.trim()]})),w(""))},z=s=>{i(t=>({...t,tags:t.tags.filter(d=>d!==s)}))},M=async s=>{if(s.preventDefault(),!!S()){k(!0);try{const t={...l,id:a?.id};v(t),j()}catch(t){console.error("Erreur lors de la sauvegarde:",t)}finally{k(!1)}}};return x?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-6 w-6 text-blue-500"}),"            ",e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:g(a?"product.modal.editTitle":"product.modal.addTitle")})]}),e.jsx("button",{onClick:j,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(B,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:M,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:["              ",e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[g("product.modal.productName")," *"]}),e.jsx(q,{value:l.name,onChange:s=>i(t=>({...t,name:s.target.value})),placeholder:g("product.modal.productNamePlaceholder"),error:n.name})]}),"            ",e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[g("product.modal.productId")," *"]}),e.jsx(q,{value:l.sku,onChange:s=>i(t=>({...t,sku:s.target.value})),placeholder:g("product.modal.productIdPlaceholder"),error:n.sku})]})]}),"          ",e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[g("product.modal.description")," *"]}),e.jsx("textarea",{value:l.description,onChange:s=>i(t=>({...t,description:s.target.value})),rows:4,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none ${n.description?"border-red-500":"border-gray-300"}`,placeholder:g("product.modal.descriptionPlaceholder")}),n.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["            ",e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[g("product.modal.factoryPrice")," *"]}),"              ",e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:l.price,onChange:s=>i(t=>({...t,price:parseFloat(s.target.value)||0})),className:`w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.price?"border-red-500":"border-gray-300"}`,placeholder:g("product.modal.factoryPricePlaceholder")}),n.price&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.price})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catégorie *"}),e.jsxs("select",{value:l.category,onChange:s=>i(t=>({...t,category:s.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.category?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Sélectionner une catégorie"}),ue.map(s=>e.jsx("option",{value:s,children:s},s))]}),n.category&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.category})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["            ",e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stock disponible"}),e.jsx("input",{type:"number",min:"0",value:l.stock,onChange:s=>i(t=>({...t,stock:parseInt(s.target.value)||0})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.stock?"border-red-500":"border-gray-300"}`,placeholder:"0"}),n.stock&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.stock})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commande minimum *"}),e.jsx("input",{type:"number",min:"1",value:l.minOrder,onChange:s=>i(t=>({...t,minOrder:parseInt(s.target.value)||1})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.minOrder?"border-red-500":"border-gray-300"}`,placeholder:"1"}),n.minOrder&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n.minOrder})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),"            ",e.jsxs("div",{className:"flex gap-2 mb-2",children:["              ",e.jsx("input",{value:f,onChange:s=>w(s.target.value),placeholder:g("product.modal.addTag"),onKeyDown:$,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(P,{type:"button",onClick:E,variant:"outline",children:e.jsx(de,{className:"w-4 h-4"})})]}),l.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:l.tags.map((s,t)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:[s,e.jsx("button",{type:"button",onClick:()=>z(s),className:"text-blue-600 hover:text-blue-800",children:e.jsx(B,{className:"w-3 h-3"})})]},t))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Spécifications techniques"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Marque *"}),e.jsx(q,{value:l.brand,onChange:s=>i(t=>({...t,brand:s.target.value})),placeholder:"Ex: Apple, Samsung...",error:n.brand})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Origine *"}),e.jsx(q,{value:l.origin,onChange:s=>i(t=>({...t,origin:s.target.value})),placeholder:"Ex: Chine, France...",error:n.origin})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Matériau"}),e.jsx(q,{value:l.material,onChange:s=>i(t=>({...t,material:s.target.value})),placeholder:"Ex: Plastique, Métal...",error:n.material})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Numéro de modèle"}),e.jsx(q,{value:l.modelNumber,onChange:s=>i(t=>({...t,modelNumber:s.target.value})),placeholder:"Ex: IP15P-128",error:n.modelNumber})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Images du produit"}),e.jsx(me,{onUpload:I,maxImages:8,maxSizePerImage:5,existingImages:l.images,onRemoveExisting:O,className:"border-2 border-dashed border-gray-300 rounded-lg"}),"            ",e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:g("product.modal.maxImages")})]}),"          ",e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx(P,{type:"button",variant:"outline",onClick:j,disabled:y,className:"flex-1",children:g("product.modal.cancel")}),"            ",e.jsxs(P,{type:"submit",disabled:y,className:"flex-1 flex items-center justify-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),y?"Sauvegarde...":g("product.modal.save")]})]})]})]})}):null},F="supplier_products_list",Ee=()=>{const{t:x,language:j}=G(),[a,v]=h.useState(()=>{try{const s=localStorage.getItem(F);if(s){const t=JSON.parse(s);if(Array.isArray(t)&&t.length>0)return t}}catch(s){console.error("Erreur lors du chargement des produits:",s)}return L}),[g,T]=h.useState(""),[l,i]=h.useState(""),[f,w]=h.useState(!1),[y,k]=h.useState(null),{success:n,error:C}=te();h.useEffect(()=>{try{localStorage.setItem(F,JSON.stringify(a)),U.syncSupplierProducts(a)}catch(s){console.error("Erreur lors de la sauvegarde des produits:",s)}},[a]);const S=a.filter(s=>{const d=A(s,j).toLowerCase().includes(g.toLowerCase()),N=!l||s.category===l;return d&&N}),I=Array.from(new Set(L.map(s=>s.category))),O=()=>{k(null),w(!0)},$=s=>{k(s),w(!0)},E=s=>{try{if(y)v(t=>t.map(d=>d.id===y.id?{...d,name:s.name,category:s.category,images:s.images||d.images,description:{...d.description,fr:s.description||d.description.fr||""}}:d)),n(`${x("supplier.products.updateSuccess")} "${s.name}"`);else{const t={...L[0],id:`prod_${Date.now()}`,name:s.name,category:s.category,description:{...L[0].description,fr:s.description||`Description de ${s.name}`},images:s.images&&s.images.length>0?s.images:["/api/placeholder/100/100"],moq:s.minOrder||1,price:{cny:s.price||0,unitCny:s.price||0},specifications:{...L[0].specifications||{},brand:s.brand||"Marque inconnue",origin:s.origin||"Origine inconnue",material:s.material||"Matériau non spécifié",modelNumber:s.modelNumber||s.sku||""}};v(d=>[t,...d]),n(`${x("supplier.products.addSuccess")} "${s.name}"`)}w(!1)}catch(t){console.error("Erreur lors de la sauvegarde:",t),C("Erreur lors de la sauvegarde du produit")}},z=s=>{confirm(x("supplier.products.deleteConfirm"))&&(v(t=>t.filter(d=>d.id!==s)),n(x("supplier.products.deleteSuccess")))},M=()=>{confirm("Êtes-vous sûr de vouloir restaurer les produits par défaut ? Tous vos produits ajoutés seront perdus.")&&(v(L),localStorage.removeItem(F),U.resetToDefault(),n(x("supplier.products.resetSuccess")))};return e.jsx(re,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:x("supplier.products.title")}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-gray-600",children:x("supplier.products.manage")}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Sauvegarde automatique activée"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Synchronisé avec l'onglet Découvrir"]})]})]})]}),"      ",e.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow-sm border p-4 mb-6",children:["        ",e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-300",size:16}),e.jsx("input",{type:"text",placeholder:x("supplier.products.search")||"Rechercher un produit...",value:g,onChange:s=>T(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-600 dark:placeholder-gray-400"})]})}),e.jsxs("div",{className:"w-full sm:w-48",children:[e.jsxs("select",{value:l,onChange:s=>i(s.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:x("search.filter.allCategories")}),I.map(s=>e.jsx("option",{value:s,children:s},s))]}),"          "]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(P,{onClick:O,className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),x("supplier.products.add")]}),"          ",e.jsxs(P,{onClick:M,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),x("supplier.products.resetDefault")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Produits"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:a.length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vues ce mois"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"12,453"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(X,{className:"w-8 h-8 text-yellow-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Note moyenne"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"4.2/5"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"w-8 h-8 text-purple-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En stock"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:Math.floor(a.length*.8)})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border",children:["        ",e.jsx("div",{className:"p-4 border-b",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[x("supplier.products.title")," (",S.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produit"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:x("category")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:x("price")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:S.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:["                      ",e.jsx("img",{className:"h-10 w-10 rounded-lg object-cover",src:s.images?.[0]||"/api/placeholder/100/100",alt:A(s,j)}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:A(s,j)}),e.jsxs("div",{className:"text-sm text-gray-500",children:["MOQ: ",s.moq," pcs"]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:s.category})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:["¥",s.price.cny," CNY"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"En stock"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:["                      ",e.jsx("button",{onClick:()=>$(s),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>z(s.id),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:e.jsx(ie,{className:"w-4 h-4"})})]})})]},s.id))})]})})]}),"      ",e.jsx(xe,{isOpen:f,onClose:()=>w(!1),product:y,onSave:E})]})})};export{Ee as default};
