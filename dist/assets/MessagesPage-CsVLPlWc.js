import{g as u,r as a,j as e,a as $,Z as d}from"./index-DbrDj4Du.js";import{B as j}from"./Button-BXIi94zn.js";import{B as A}from"./BackButton-FxuuiGHy.js";import{S as B}from"./SupplierLayout-BDztLqG7.js";import{P as L}from"./plus-7lddUlfR.js";import{M as v}from"./message-square-BGKFoHMd.js";import"./arrow-left-2Q9fRMZ4.js";import"./chart-column-zn556lbz.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],_=u("ellipsis-vertical",P);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],m=u("paperclip",F);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],q=u("send",U),c=[{id:"1",conversationId:"conv1",from:"Marie Dupont",fromType:"customer",to:"Shanghai Electronics Co.",subject:"Question sur la commande ORD-2024-001",content:"Bonjour, je souhaiterais savoir si ma commande de smartphones sera bien livrée demain comme prévu ?",timestamp:new Date("2024-01-15T10:30:00"),isRead:!1,hasAttachment:!1,priority:"normal"},{id:"2",conversationId:"conv1",from:"Shanghai Electronics Co.",fromType:"supplier",to:"Marie Dupont",subject:"Re: Question sur la commande ORD-2024-001",content:"Bonjour Marie, votre commande a bien été expédiée et sera livrée demain avant 18h. Vous recevrez un SMS de confirmation.",timestamp:new Date("2024-01-15T11:15:00"),isRead:!0,hasAttachment:!1,priority:"normal"},{id:"3",conversationId:"conv2",from:"Jean Martin",fromType:"customer",to:"Shanghai Electronics Co.",subject:"Demande de devis pour commande groupée",content:"Bonjour, je représente une boutique de mode et je souhaiterais obtenir un devis pour une commande de 100 articles textiles. Pouvez-vous me faire une offre personnalisée ?",timestamp:new Date("2024-01-14T16:45:00"),isRead:!1,hasAttachment:!0,priority:"high"},{id:"4",conversationId:"conv3",from:"Support ChineTonUsine",fromType:"admin",to:"Shanghai Electronics Co.",subject:"Mise à jour des conditions de vente",content:"Cher partenaire, nous vous informons d'une mise à jour de nos conditions générales de vente qui entrera en vigueur le 1er février 2024.",timestamp:new Date("2024-01-13T09:00:00"),isRead:!0,hasAttachment:!0,priority:"normal"}],O=[{id:"conv1",participants:["Marie Dupont","Shanghai Electronics Co."],lastMessage:c[1],unreadCount:0,subject:"Question sur la commande ORD-2024-001"},{id:"conv2",participants:["Jean Martin","Shanghai Electronics Co."],lastMessage:c[2],unreadCount:1,subject:"Demande de devis pour commande groupée"},{id:"conv3",participants:["Support ChineTonUsine","Shanghai Electronics Co."],lastMessage:c[3],unreadCount:0,subject:"Mise à jour des conditions de vente"}],X=()=>{const[x,N]=a.useState([]),[w,p]=a.useState([]),[i,k]=a.useState(null),[C,h]=a.useState(!1),[l,M]=a.useState(""),[n,g]=a.useState(""),[f,S]=a.useState(""),y=a.useCallback(async()=>{h(!0);try{await new Promise(s=>setTimeout(s,1e3)),N(O),p(c)}catch(s){console.error("Erreur lors du chargement:",s),S(s instanceof Error?s.message:"Erreur lors du chargement des messages")}finally{h(!1)}},[]);a.useEffect(()=>{y()},[y]);const T=x.filter(s=>s.subject.toLowerCase().includes(l.toLowerCase())||s.participants.some(t=>t.toLowerCase().includes(l.toLowerCase()))),r=i?w.filter(s=>s.conversationId===i):[],b=s=>{const I=new Date().getTime()-s.getTime(),o=Math.floor(I/(1e3*60*60*24));return o===0?new Intl.DateTimeFormat("fr-FR",{hour:"2-digit",minute:"2-digit"}).format(s):o===1?"Hier":o<7?`Il y a ${o} jours`:new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short"}).format(s)},z=s=>({low:"bg-gray-100 text-gray-800",normal:"bg-blue-100 text-blue-800",high:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",D=s=>({customer:e.jsx(d,{size:16}),supplier:e.jsx(v,{size:16}),admin:e.jsx(d,{size:16})})[s]||e.jsx(d,{size:16}),E=()=>{if(!n.trim()||!i)return;const s={id:Date.now().toString(),conversationId:i,from:"Shanghai Electronics Co.",fromType:"supplier",to:r[0]?.fromType==="supplier"?r[0].to:r[0].from,subject:`Re: ${r[0]?.subject}`,content:n,timestamp:new Date,isRead:!0,hasAttachment:!1,priority:"normal"};p(t=>[...t,s]),g("")},R=x.reduce((s,t)=>s+t.unreadCount,0);return e.jsxs(B,{children:[e.jsx("div",{className:"mb-6",children:e.jsx(A,{to:"/supplier/dashboard",label:"Retour au tableau de bord",variant:"ghost"})}),e.jsxs("div",{className:"flex h-[calc(100vh-2rem)] bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-200 dark:border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Messages"}),e.jsxs(j,{size:"sm",className:"flex items-center gap-2",children:[e.jsx(L,{size:16}),"Nouveau"]})]}),"            ",e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-300",size:16}),e.jsx("input",{type:"text",placeholder:"Rechercher conversations...",value:l,onChange:s=>M(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-500 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-600 dark:placeholder-gray-400"})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Messages non lus"}),e.jsx("span",{className:"bg-blue-600 text-white px-2 py-1 rounded-full text-xs font-medium",children:R})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:C?e.jsx("div",{className:"p-8 text-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:T.map(s=>e.jsx("div",{onClick:()=>k(s.id),className:`p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${i===s.id?"bg-blue-50 dark:bg-blue-900/20 border-r-2 border-blue-600":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[D(s.lastMessage.fromType),e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:s.participants.find(t=>t!=="Shanghai Electronics Co.")}),s.unreadCount>0&&e.jsx("span",{className:"bg-blue-600 text-white px-2 py-1 rounded-full text-xs font-medium",children:s.unreadCount})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1 truncate",children:s.subject}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 truncate",children:s.lastMessage.content})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500 flex flex-col items-end gap-1",children:[b(s.lastMessage.timestamp),s.lastMessage.hasAttachment&&e.jsx(m,{size:12})]})]})},s.id))})})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:r[0]?.subject}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Avec ",r[0]?.fromType==="supplier"?r[0].to:r[0].from]})]}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(_,{size:20})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:r.map(s=>e.jsx("div",{className:`flex ${s.fromType==="supplier"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${s.fromType==="supplier"?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium",children:s.from}),s.priority==="high"&&e.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${z(s.priority)}`,children:"Urgent"})]}),e.jsx("p",{className:"text-sm",children:s.content}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:`text-xs ${s.fromType==="supplier"?"text-blue-100":"text-gray-500 dark:text-gray-400"}`,children:b(s.timestamp)}),s.hasAttachment&&e.jsx(m,{size:12,className:s.fromType==="supplier"?"text-blue-100":"text-gray-500"})]})]})},s.id))}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("textarea",{value:n,onChange:s=>g(s.target.value),placeholder:"Tapez votre message...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none dark:bg-gray-700 dark:border-gray-600 dark:text-white"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(m,{size:20})}),e.jsxs(j,{onClick:E,disabled:!n.trim(),size:"sm",className:"flex items-center gap-2",children:[e.jsx(q,{size:16}),"Envoyer"]})]})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Sélectionnez une conversation"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Choisissez une conversation pour voir les messages"})]})})}),f&&e.jsx("div",{className:"absolute top-4 right-4 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-600",children:f})})]})]})};export{X as default};
